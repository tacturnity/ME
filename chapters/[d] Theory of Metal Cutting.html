<!DOCTYPE html>
<html lang="en" style="--base-font-size: 10px;"> <!-- Default font size set to 10px -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4: Theory of Metal Cutting</title> <!-- CHANGE THIS TITLE -->

    <!-- Google Fonts - Roboto Mono -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&amp;display=swap" rel="stylesheet">

    <!-- MathJax Configuration -->
    <script>
        MathJax = {
          tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true, tags: 'ams' },
          options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'], ignoreHtmlClass: 'tex2jax_ignore', processHtmlClass: 'tex2jax_process' },
          svg: { fontCache: 'global' },
          startup: {
            ready: () => { console.log('MathJax ready.'); MathJax.startup.defaultReady(); MathJax.startup.promise.then(() => console.log('MathJax initial typeset complete.')); }
          }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        /* Basic Reset */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        /* Keyframes for Animations (FadeIn) */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }

        /* Fonts & Base Styling */
        body {
            font-family: 'Roboto Mono', monospace;
            color: #e0e0e0;
            line-height: 1.7;
            padding: 25px;
            background-color: #1a1a1a;
            min-height: 100vh;
            font-size: var(--base-font-size); /* Controlled by JS */
            transition: font-size 0.2s ease-in-out; /* Default smooth transition */
            padding-bottom: 80px; /* Space for controls */
            overflow-x: hidden;
        }
        /* Class to disable transition during rapid changes (e.g., hold) */
        body.no-font-transition {
            transition: none !important;
        }

        /* Headings */
        h1, h2 { font-family: 'Roboto Mono', monospace; text-align: center; margin-bottom: 1.5em; }
        h1 { font-size: 2.4em; color: #ffffff; font-weight: 700; padding-bottom: 12px; margin-top: 1.5em; margin-bottom: 1.5em; border-bottom: 2px solid #ffffff; animation: fadeIn 0.8s ease-out both; animation-delay: 0.1s; letter-spacing: -0.5px; }
        h2 { font-size: 1.6em; color: #cccccc; font-weight: 500; margin-top: 30px; margin-bottom: 1.5em; border-bottom: 1px solid #555555; padding-bottom: 5px; animation: fadeIn 0.8s ease-out both; animation-delay: 0.3s; }
        h3 { font-size: 1.2em; color: #bdbdbd; font-weight: 500; margin-top: 1.8em; margin-bottom: 0.8em; padding-bottom: 3px; border-bottom: 1px dotted #444; text-align: left; }
        h4 { font-size: 1.1em; color: #b0b0b0; font-weight: 500; margin-top: 1.5em; margin-bottom: 0.7em; text-align: left; }


        /* Main Content Area */
        main { max-width: 800px; margin: 40px auto; background-color: rgba(30, 30, 30, 0.85); padding: 35px 45px; border-radius: 10px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.7); backdrop-filter: blur(6px); border: 1px solid rgba(255, 255, 255, 0.1); animation: fadeIn 0.8s ease-out both; animation-delay: 0.2s; }
        /* Paragraph and List styling */
        p { margin-bottom: 1em; color: inherit; font-size: inherit; }
        ul, ol { margin-left: 25px; list-style: disc; margin-bottom: 1em; }
        ol { list-style: decimal; }
        li { margin-bottom: 8px; font-size: inherit; }
        strong { font-weight: 500; color: #ffffff; }

        /* Formula Container Styling (with horizontal scroll) */
        .formula-container {
            margin: 15px 0 20px 0; padding: 10px 20px; background-color: rgba(45, 45, 45, 0.9);
            border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto; overflow-y: hidden; /* Horizontal scroll, no vertical */
            transition: background-color 0.3s ease, border-color 0.3s ease;
            cursor: pointer; color: #e0e0e0; border-left: 4px solid transparent;
            font-family: 'Roboto Mono', monospace; position: relative; white-space: nowrap;
        }
        .formula-container:hover { background-color: rgba(60, 60, 60, 0.95); border-left-color: #a6e3a1; border-color: rgba(166, 227, 161, 0.5); }
        .formula-container.copied { background-color: rgba(166, 227, 161, 0.2); border-color: #a6e3a1; border-left-color: #a6e3a1; }
        /* Optional Scrollbar Style */
        .formula-container::-webkit-scrollbar { height: 8px; }
        .formula-container::-webkit-scrollbar-track { background: rgba(60, 60, 60, 0.5); border-radius: 4px; }
        .formula-container::-webkit-scrollbar-thumb { background-color: #888; border-radius: 4px; border: 2px solid transparent; background-clip: content-box; }
        .formula-container::-webkit-scrollbar-thumb:hover { background-color: #aaa; }
        /* MathJax display style */
        .formula-container mjx-container[display="true"] { margin: 0.5em 0 !important; text-align: left !important; display: inline-block; vertical-align: middle; }

        table { border-collapse: collapse; margin: 1em auto; background-color: rgba(40,40,40,0.8); width: auto; }
        th, td { border: 1px solid #555; padding: 8px 12px; text-align: center; }
        th { background-color: rgba(60,60,60,0.9); color: #ddd; }

        pre {
            background-color: #2b2b2b; padding: 10px; border-radius: 5px;
            color: #ccc; overflow-x: auto; white-space: pre;
            font-family: 'Roboto Mono', monospace; font-size: 0.95em;
            margin: 1em 0;
        }

        /* Footer Styling */
        footer { text-align: center; margin-top: 70px; padding-bottom: 35px; font-size: 0.85em; color: #888888; animation: fadeIn 1s ease-out both; animation-delay: 0.7s; }

        /* Simple Dark Theme Scrollbar for Page */
        body::-webkit-scrollbar { width: 10px; }
        body::-webkit-scrollbar-track { background: #2a2a2a; border-radius: 5px; }
        body::-webkit-scrollbar-thumb { background-color: #777; border-radius: 5px; border: 2px solid #2a2a2a; background-clip: content-box; }
        body::-webkit-scrollbar-thumb:hover { background-color: #999; }
        html { scrollbar-width: thin; scrollbar-color: #777 #2a2a2a; }
        @supports (scrollbar-gutter: stable) { html { scrollbar-gutter: stable; } }

        /* Font Control Icons CSS */
        .font-control { position: fixed; bottom: 0; left: 0; width: 100%; padding: 10px 25px; box-sizing: border-box; display: flex; justify-content: space-between; align-items: center; pointer-events: none; z-index: 10; }
        .font-control-icon { font-size: 28px; font-weight: bold; color: #777; cursor: pointer; padding: 8px; transition: color 0.3s ease; pointer-events: auto; user-select: none; line-height: 1; display: inline-block; }
        .font-control-icon:hover { color: #a6e3a1; }
        #fontSizeDisplay { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); background-color: rgba(45, 45, 45, 0.9); color: #e0e0e0; padding: 6px 12px; border-radius: 5px; font-size: 13px; font-family: 'Roboto Mono', monospace; z-index: 11; opacity: 0; transition: opacity 0.3s ease-in-out; pointer-events: none; white-space: nowrap; }
        #fontSizeDisplay.visible { opacity: 1; }
    </style>
</head>
<body>

    <header>
        <h1>Chapter 4: Theory of Metal Cutting</h1> <!-- EDIT THIS LINE -->
    </header>

    <main>
        <p>
            This chapter explains the fundamentals of metal cutting (machining). It starts by defining machining and machine tools, then delves into the mechanism of metal cutting, essential properties and types of cutting tool materials, classification of cutting tools, the geometry of single-point cutting tools including various angles, types of chips produced, thermal aspects of machining, tool failure modes, the role of cutting fluids, operating conditions (speed, feed, depth of cut), and the concept of tool life including Taylor's equation.
        </p>

        <h2>4.1 Introduction (Figure 4.1)</h2>

        <ul>
            <li>
                <strong>Machining (Metal Cutting):</strong> The process of removing unwanted material (chip or scrap) from a workpiece (stock) using a machine and a cutting tool to achieve a desired shape and size.
                 <ul>
                     <li>
                         **(Fig. 4.1):** Shows a raw cylindrical bar (a), the desired stepped diameter finished product (b), and the metal to be cut (c).
                     </li>
                 </ul>
            </li>
            <li>
                <strong>Cutting tool:</strong> The device used to cut the material.
            </li>
            <li>
                <strong>Machine tools:</strong> Power-driven machines that shape metals (or other materials) to produce components by operations like cutting.
            </li>
        </ul>
        <p>
             Machining is often necessary/preferred for:
        </p>
        <ol>
            <li>
                Achieving closer dimensional accuracy than other processes (casting, forming).
            </li>
            <li>
                Finishing heat-treated parts that may have distorted.
            </li>
            <li>
                Producing special surface characteristics (e.g., high reflectivity with diamond tools).
            </li>
            <li>
                Economical production, especially in small quantities.
            </li>
            <li>
                When shape/size is unsuitable for other methods.
            </li>
        </ol>
        <p>
             Metal cutting constitutes about 35% of all manufacturing processes. Machining should be avoided if possible as it produces waste, consumes more energy/capital/labor, and can take longer than forming/shaping. On average, about half the material is removed as chips.
        </p>

        <h2>4.2 Machine Tools</h2>

        <p>
             Machines on which metal cutting or forming processes are carried out.
        </p>
        <p>
             **Functions:** Holding workpiece, holding tool, providing relative motion between tool and workpiece, supplying energy for cutting.
        </p>
        <ul>
            <li>
                **Machine vs. Machine Tool:** A machine converts input to output (e.g., refrigerator). Machine tools are a specific type of machine that imparts shape by removing material as chips.
            </li>
            <li>
                **Broad Classification:**
                <ol>
                    <li>
                        Metal cutting machine tools.
                    </li>
                    <li>
                        Metal forming machine tools.
                    </li>
                </ol>
            </li>
            <li>
                **Classification of Metal Cutting Machine Tools (Examples):**
                <ul>
                    <li>
                        **Degree of specialization:**
                        <ol>
                            <li>
                                General-purpose (lathe, shaper, milling machine).
                            </li>
                            <li>
                                Special-purpose (gear-cutting/hobbing machine).
                            </li>
                        </ol>
                    </li>
                    <li>
                        **Type of surface produced:**
                        <ol>
                            <li>
                                Cylindrical surface (lathe, drilling machine).
                            </li>
                            <li>
                                Flat surface (milling machine, shaper).
                            </li>
                        </ol>
                    </li>
                    <li>
                        **Type of motion:**
                        <ol>
                            <li>
                                Reciprocatory (shaper, planer, slotter).
                            </li>
                            <li>
                                Rotary (lathe, drilling machine, grinding machine).
                            </li>
                        </ol>
                    </li>
                    <li>
                         **Degree of automation:** Manual, Semi-automatic, Automatic.
                    </li>
                    <li>
                         **Duty cycle:** Light, Medium, Heavy duty.
                    </li>
                    <li>
                        **Type of energy used:**
                        <ol>
                            <li>
                                Conventional (mechanical energy: lathe, drilling).
                            </li>
                            <li>
                                Non-conventional (chemical, electro-discharge energy).
                            </li>
                        </ol>
                    </li>
                </ul>
            </li>
        </ul>

        <h2>4.3 Cutting Tools</h2>

        <p>
            Device used to remove unwanted material. Essential for machining.
        </p>

        <h3>4.3.1 Mechanism of metal cutting (Figure 4.2)</h3>
        <p>
             Similar to sharpening a pencil or peeling an apple.
        </p>
        <ul>
             <li>
                 Tool penetrates workpiece and moves forward, chipping off a layer.
             </li>
             <li>
                 **(Fig. 4.2):** Workpiece clamped, wedge-shaped tool set to a depth of cut, forced to move.
             </li>
             <li>
                 Sharp edge forced into metal. Stress increases beyond elastic limit, then ultimate strength.
             </li>
             <li>
                 Shear failure occurs, separating a layer as a **chip** (Fig. 4.2b).
             </li>
             <li>
                 Continued relative motion removes a layer as a chip (Fig. 4.2c).
             </li>
             <li>
                 **Essential properties of a cutting tool:**
                 <ul>
                     <li>
                         Harder than work material (to penetrate).
                     </li>
                     <li>
                         Strong enough to withstand cutting forces (not bend/deform).
                     </li>
                     <li>
                         Hard and tough.
                     </li>
                     <li>
                         Heat resistant (high hot hardness) to maintain hardness at high temperatures ($>600^\circ C$ for HSS).
                     </li>
                     <li>
                         Wear resistant to prevent fast wear of cutting edge.
                     </li>
                     <li>
                         (Tool &amp; workpiece experience high pressure, friction, heating, leading to wear).
                     </li>
                 </ul>
             </li>
        </ul>

        <h2>4.4 Tool Materials</h2>

        <p>
             Performance depends on wear resistance, hot hardness, toughness (gain in one often means loss in other). Development of new tool materials often drives machine tool design changes. Materials include: tool steels, high-speed steels (HSS), carbides, UCON, ceramics, synthetic diamond, Cubic Boron Nitride (CBN).
        </p>

        <h3>4.4.1 Tool steel (TS) (Carbon Tool Steel)</h3>
        <ul>
            <li>
                Carbon content 0.8-1.5%. Easily hardened. For cutting ferrous/non-ferrous metals.
            </li>
            <li>
                <em>Disadvantages:</em> Low hot hardness (loses hardness at 200-250°C), poor wear resistance. Used for low cutting speeds.
            </li>
             <li>
                 **Effect of alloying elements (Table 4.1):**
                 <ul>
                     <li>
                         **Mn:** Improves machinability (Free Cutting steels).
                     </li>
                     <li>
                         **Ni:** Improves strength, toughness, corrosion resistance.
                     </li>
                     <li>
                         **Cr:** Improves strength, toughness, corrosion resistance.
                     </li>
                     <li>
                         **P:** Causes brittleness, improves machinability.
                     </li>
                     <li>
                         **S:** Reduces hot hardness, improves machinability.
                     </li>
                     <li>
                         **Si:** Makes steel tough and harder.
                     </li>
                 </ul>
             </li>
        </ul>

        <h3>4.4.2 High-speed steel (HSS)</h3>
        <ul>
            <li>
                 Alloy steel (Tungsten, Chromium, Molybdenum etc.). Retains hardness up to 600°C.
            </li>
            <li>
                 Superior hot hardness and wear resistance. Cutting speeds 2-3 times &gt; carbon steels.
            </li>
             <li>
                 **Types (based on alloying %):**
                 <ul>
                     <li>
                         **18-4-1 HSS (Tungsten based):** 18% W, 4% Cr, 1% V. Good hot hardness, form stability.
                     </li>
                     <li>
                         **8-4-1 HSS (Molybdenum based):** 8% Mo, 4% Cr, 1% V. Efficient as 18-4-1 (half Mo needed for same effect as W by weight). Excellent toughness, cutting ability.
                     </li>
                     <li>
                         **Cobalt based HSS (Super HSS):** Contains 2-15% Co. Increases hot hardness and wear resistance. Very high operating speeds.
                     </li>
                 </ul>
            </li>
             <li>
                 **(Table 4.2 Effect of alloying elements on HSS):**
                 <ul>
                     <li>
                         **Tungsten:** Increases hot hardness, wear resistance, form stability.
                     </li>
                     <li>
                         **Molybdenum:** Increases hot hardness, maintains keenness of cutting edge.
                     </li>
                     <li>
                         **Vanadium:** Increases wear resistance.
                     </li>
                     <li>
                         **Cobalt:** Increases wear resistance and hot hardness.
                     </li>
                 </ul>
            </li>
        </ul>

        <h3>4.4.3 Carbides (Cemented Carbides/Sintered Carbides)</h3>
        <ul>
            <li>
                 Basic ingredient: Tungsten Carbide (WC).
            </li>
            <li>
                 For steel machining: e.g., 82% WC, 10% Titanium Carbide (TiC), 8% Cobalt (binder).
            </li>
            <li>
                 Very high hardness over wide temperature range, high thermal conductivity.
            </li>
            <li>
                 Tendency for pressure welds at low speeds; operate at high speeds (&gt;&gt; HSS).
            </li>
        </ul>

        <h3>4.4.4 Abrasives</h3>
        <ul>
            <li>
                For machining harder materials or where superior finish needed.
            </li>
            <li>
                Used in grinding wheels. (Discussed later in abrasive machining chapter).
            </li>
        </ul>

        <h3>4.4.5 Diamond</h3>
        <ul>
            <li>
                 Hardest known material. Cutting speeds ~50 times HSS.
            </li>
            <li>
                 For very hard materials (ceramics). Can machine 10,000-100,000 pieces vs 300-400 for carbides.
            </li>
            <li>
                 Performs well at highest speeds, low feeds, low depth of cut.
            </li>
            <li>
                 Requires excellent machine condition (vibration-free) due to brittleness.
            </li>
            <li>
                 Not thermally stable, reacts with iron at high temp ($>700^\circ C$).
            </li>
        </ul>

        <h3>4.4.6 Cubic Boron Nitride (CBN)</h3>
        <ul>
            <li>
                 Alternative to diamond for ferrous materials. N + B, diamond-like structure.
            </li>
            <li>
                 Second hardest material. Red hardness up to 1000°C.
            </li>
        </ul>

        <h3>4.4.7 UCON</h3>
        <ul>
            <li>
                 Alloy: 50% Columbium (Niobium), 30% Titanium, 20% Tungsten.
            </li>
            <li>
                 Harder than WC. Excellent thermal shock resistance, high hardness &amp; toughness.
            </li>
            <li>
                 Tool life 3-5 times conventional carbides.
            </li>
        </ul>

        <h3>4.4.8 Ceramics</h3>
        <ul>
            <li>
                 Inexpensive substitute for carbides. Main constituent: Aluminum Oxide (Al₂O₃).
            </li>
            <li>
                 Cuts almost any metal, withstands high heat. Very brittle, no shock.
            </li>
            <li>
                 Extremely fine finishes. Speeds twice that of carbides. Red hardness ~1200°C.
            </li>
        </ul>

        <h3>4.4.9 Tipped tools (Figure 4.3)</h3>
        <ul>
            <li>
                 Alloy steel &amp; HSS tools usually one piece.
            </li>
            <li>
                 Carbides, CBN, diamond tools: Cutting edges made from these materials, brazed or clamped to tool shank (due to cost, non-availability, manufacturing difficulty).
            </li>
            <li>
                 **(Fig. 4.3):** Shows tool insert brazed to shank.
            </li>
            <li>
                 Clamped inserts can be **indexed**: rotated to use a new cutting edge when one becomes blunt (e.g., triangular insert has 3 edges, trebling tool life).
            </li>
        </ul>

        <h3>4.4.10 Coated tools</h3>
        <ul>
            <li>
                 HSS tool performance improved by coating cutting edges with carbides (e.g., TiC, TiN).
            </li>
            <li>
                 Thin coating (5-7 µm) improves wear resistance, hardness, hot hardness.
            </li>
        </ul>

        <h2>4.5 Types of Tools (Figure 4.4)</h2>

        <p>
             Broadly classified:
        </p>
        <ul>
            <li>
                **4.5.1 Single point tools (Fig. 4.4a):** Only one cutting edge. Used in lathes, shapers, planers.
            </li>
            <li>
                **4.5.2 Multipoint tools (Fig. 4.4b):** More than one cutting edge. Each tooth cuts independently.
                <ul>
                    <li>
                         **Example (Fig. 4.4b):** Milling cutter. Other examples: drills, reamers.
                    </li>
                </ul>
            </li>
        </ul>

        <h2>4.6 Tool Geometry</h2>

        <p>
            Size and shape of the tool. Depends on operation. (Drill is cylindrical, turning tool is prismatic).
        </p>

        <h3>Early Cutting Tools (Figure 4.5)</h3>
        <ul>
            <li>
                 Chisel (Fig. 4.5a) was likely a first tool, blunt edge.
            </li>
            <li>
                 Experience led to importance of angles: rake angle, clearance angle, setting angle (Fig. 4.5b). These reduce friction, ease chip disposal, reduce force, lower wear, increase tool life.
            </li>
        </ul>

        <h3>4.6.1 Geometry of single-point turning tool (Figure 4.6)</h3>
        <p>
             Consists of **shank** (body, for holding) and **neck** (operating end).
        </p>
        <p>
             **Neck elements:**
        </p>
        <ul>
            <li>
                 **Face:** Surface on which chip impinges and flows.
            </li>
            <li>
                 **Flanks:** Surfaces facing the work.
                 <ul>
                     <li>
                         **Side (Main) flank.**
                     </li>
                     <li>
                         **End (Auxiliary) flank.**
                     </li>
                 </ul>
            </li>
            <li>
                 **Cutting Edges:** Intersection of face and flanks.
                 <ul>
                     <li>
                         **Side (Main) cutting edge:** Intersection of face and side flank (main sharp edge).
                     </li>
                     <li>
                         **End cutting edge:** Intersection of face and end flank.
                     </li>
                 </ul>
            </li>
            <li>
                 **Nose:** Junction of side and end cutting edges. Often has a small **nose radius**.
            </li>
        </ul>

        <h3>4.6.2 Cutting tool angles (Figure 4.6, 4.7, 4.8)</h3>
        <p>
             Five main angles define geometry. (Angles are relative to machined surface).
        </p>
        <ul>
            <li>
                **Back Rake Angle (α or commonly just Rake Angle) (Fig. 4.7):** Angle between tool face and normal to machined surface at cutting edge.
                <ul>
                    <li>
                        **Positive rake (Fig. 4.7a):** Less tool strength (smaller cross-section), lower cutting forces, sharper edge. Good for soft materials.
                    </li>
                    <li>
                        **Zero rake (Fig. 4.7b):**
                    </li>
                    <li>
                        **Negative rake (Fig. 4.7c):** Strongest tool (larger cross-section), higher cutting forces. Good for hard/brittle materials, interrupted cuts.
                    </li>
                </ul>
            </li>
            <li>
                **Side Rake Angle:** Angle between tool face and line parallel to tool base, measured in plane perpendicular to base and side cutting edge. Gives slope of face from cutting edge.
            </li>
            <li>
                **Relief Angle (Clearance Angle):** Angle between tool flank and tangent to machined surface at cutting edge.
                <ul>
                    <li>
                        **Side relief angle.**
                    </li>
                    <li>
                        **End relief angle.**
                    </li>
                    <li>
                        Enables flank to clear workpiece surface, prevents rubbing.
                    </li>
                </ul>
            </li>
            <li>
                **Side Cutting Edge Angle (Lead Angle):** Angle formed by side cutting edge with normal to machined surface. Allows tool to contact work back from tip at start of cut. Large angle increases force tending to push tool away.
            </li>
            <li>
                **End Cutting Edge Angle:** Angle formed by end cutting edge with machined surface. Provides clearance behind nose radius, reduces length of edge in contact. Prevents rubbing.
            </li>
        </ul>
        <p>
             **(Fig. 4.8)** illustrates these angles on a tool.
        </p>


        <h2>4.7 Tool Signature</h2>

        <p>
             Sequence of numbers specifying single-point tool geometry.
        </p>
        <ul>
            <li>
                **Example: 8-14-6-8-8-19-1** (Units are typically degrees for angles, mm for nose radius)
                <ul>
                    <li>
                        8: Back rake angle
                    </li>
                    <li>
                        14: Side rake angle
                    </li>
                    <li>
                        6: End relief angle
                    </li>
                    <li>
                        8: Side relief angle
                    </li>
                    <li>
                        8: End cutting edge angle
                    </li>
                    <li>
                        19: Side cutting edge angle
                    </li>
                    <li>
                        1: Nose radius
                    </li>
                </ul>
            </li>
        </ul>

        <h2>4.8 Left Hand and Right Hand Tools (Figure 4.9)</h2>

        <p>
             Classified by direction of feed.
        </p>
        <ul>
            <li>
                **Right hand tool (Fig. 4.9a):** Side cutting edge on thumb side when right hand placed on tool, fingers towards nose. Cuts from right to left (in a lathe).
            </li>
            <li>
                **Left hand tool (Fig. 4.9b):** Side cutting edge on thumb side when left hand placed similarly. Cuts from left to right.
            </li>
        </ul>

        <h2>4.9 Orthogonal and Oblique Cutting (Figure 4.10)</h2>

        <p>
             All metal cutting involves wedge tool, straight cutting edge, relative velocity, chip formation.
        </p>
        <ul>
            <li>
                **Orthogonal Cutting (Two-dimensional cutting) (Fig. 4.10a):**
                <ul>
                    <li>
                         Cutting edge is normal (90°) to the direction of tool motion/workpiece velocity.
                    </li>
                    <li>
                         No forces perpendicular to relative motion (idealized).
                    </li>
                    <li>
                         Often used for analysis.
                    </li>
                </ul>
            </li>
            <li>
                **Oblique Cutting (Three-dimensional cutting) (Fig. 4.10b):**
                <ul>
                    <li>
                         Cutting edge is inclined at an angle (inclination angle) to the direction of tool motion.
                    </li>
                    <li>
                         Most common type. Cutting forces exist in three mutually perpendicular directions.
                    </li>
                </ul>
            </li>
        </ul>

        <h2>4.10 Types of Chips (Figure 4.11)</h2>

        <p>
            Chip formation depends on work material and cutting conditions.
        </p>
        <ol>
            <li>
                **Continuous chips (Fig. 4.11a):**
                <ul>
                    <li>
                         From ductile materials (e.g., mild steel).
                    </li>
                    <li>
                         Long, single piece. Hazardous (wraps on tool/work).
                    </li>
                    <li>
                         Broken into smaller pieces by **chip breakers** (integral to tool or separate).
                    </li>
                </ul>
            </li>
            <li>
                **Discontinuous or Segmental chips (Fig. 4.11b):**
                <ul>
                    <li>
                         Small pieces. From brittle materials (e.g., cast iron).
                    </li>
                    <li>
                         Fairly good surface finish, increased tool life.
                    </li>
                </ul>
            </li>
            <li>
                **Continuous chips with Built-Up Edge (BUE) (Fig. 4.11c):**
                <ul>
                    <li>
                         Temperature rise, high pressure &rarr; alloying/welding action between hot chip and tool face.
                    </li>
                    <li>
                         Weakened material particles weld to tool tip, forming a "false cutting edge" (BUE).
                    </li>
                    <li>
                         Common with aluminum, stainless steels.
                    </li>
                    <li>
                         Grows, breaks down, part sticks to chip, part to work surface &rarr; rough surface.
                    </li>
                    <li>
                         Promoted by low cutting speeds, large depth of cut. Highly undesirable.
                    </li>
                </ul>
            </li>
        </ol>

        <h2>4.11 Thermal Aspects in Machining (Figure 4.12)</h2>

        <p>
             Energy dissipated in cutting converts to heat &rarr; raises cutting zone temperature.
        </p>
        <p>
             **Effects of heat:**
        </p>
        <ol>
            <li>
                 Reduces tool hardness, makes it less wear-resistant. High temp can temper tool, reducing hardness, increasing wear.
            </li>
            <li>
                 Causes dimensional changes in workpiece (accuracy issues).
            </li>
            <li>
                 Can distort machine tool accuracy.
            </li>
        </ol>
        <p>
             Heat generation depends on: rate of metal cutting, cutting speed, specific heat &amp; thermal conductivity of work/tool.
        </p>
        <ul>
            <li>
                 **Cutting speed:** Major influence. Higher speed &rarr; less time for heat dissipation &rarr; higher temp.
            </li>
            <li>
                 Higher specific heat/thermal conductivity of tool/work &rarr; lower temp.
            </li>
        </ul>
        <p>
             **Heat Distribution:**
        </p>
         <div class="formula-container"
             onclick="copyFormulaLatex(this, this.dataset.latex)"
             data-latex="\color{white} Q = Q_1 + Q_2 + Q_3 + Q_4 \quad (\text{Eq } 4.1)"
             title="Click to copy LaTeX (equation number will be removed)">
             $$ \color{white} Q = Q_1 + Q_2 + Q_3 + Q_4 \quad (\text{Eq } 4.1) $$
        </div>
         <ul>
             <li>
                 $Q_1$: Heat with chips.
             </li>
             <li>
                 $Q_2$: Heat into tool.
             </li>
             <li>
                 $Q_3$: Heat into workpiece.
             </li>
             <li>
                 $Q_4$: Heat to surroundings (negligible).
             </li>
         </ul>
         <p>
              **Typical distribution:** Chips (80%), Tool (10%), Workpiece (10%). (Fig. 4.12)
         </p>
         <ul>
             <li>
                 Chips carry most heat, regardless of speed. This is why higher speeds are feasible despite reduced tool life.
             </li>
             <li>
                 Hot chips can cause burns; handle with care.
             </li>
         </ul>

        <h2>4.12 Failure of Tool</h2>

        <p>
             Tool fails when it ceases to function satisfactorily.
        </p>
        <ol>
            <li>
                 **Catastrophic failure:** Cutting force exceeds tool material's critical strength. Fails without warning.
            </li>
            <li>
                 **Gradual or Progressive wear:** Normal condition. Starts with cutting, progresses.
                 <ul>
                     <li>
                         **4.12.1 Crater wear (Figure 4.13):**
                         <ul>
                             <li>
                                 On rake face, away from cutting edge. Due to chip rubbing.
                             </li>
                             <li>
                                 Progresses, weakens cutting edge, can lead to chipping.
                             </li>
                             <li>
                                 Reduced by chip breakers.
                             </li>
                         </ul>
                    </li>
                    <li>
                        **4.12.2 Flank wear (Figure 4.14):**
                        <ul>
                            <li>
                                On tool flank. Due to continuous contact between newly machined surface and flank (due to depth of cut).
                            </li>
                        </ul>
                    </li>
                 </ul>
            </li>
        </ol>

        <h2>4.13 Cutting Fluids (Coolants)</h2>

        <p>
             Applied to tool-workpiece-chip zone to improve machining performance. Cooling is essential, especially at high speeds.
        </p>
        <p>
             **Functions:**
        </p>
        <ol>
            <li>
                 Absorb/carry away heat (lower cutting zone temp).
            </li>
            <li>
                 Cool workpiece and tool.
            </li>
            <li>
                 Reduce friction (lubricate) &rarr; reduce heat generation.
            </li>
            <li>
                 Wash away chips.
            </li>
            <li>
                 Carry away BUE.
            </li>
            <li>
                 Give fine surface finish.
            </li>
            <li>
                 Prevent corrosion (tool, work, machine).
            </li>
        </ol>
        <p>
             Improvement depends on tool/work material, fluid type, cutting conditions.
        </p>
        <p>
             **Types:** Water (excellent coolant, poor lubricant, causes rust). Mineral soluble oils added to water improve properties. Compressed air, kerosene, liquid air.
        </p>

        <h2>4.14 Operating Conditions in Metal Cutting</h2>

        <p>
            Parameters: (a) Cutting speed, (b) Feed, (c) Depth of cut. Defined differently for different machine tools.
        </p>

        <h3>4.14.1 Cutting speed (v)</h3>
        <ul>
            <li>
                 Distance travelled by work surface in unit time relative to cutting edge (m/min).
            </li>
            <li>
                 For rotating workpiece, it's peripheral speed.
            </li>
            <li>
                 Determined by: machining process, machine tool, tool/work material, cutting fluid, finish, accuracy, tool life.
            </li>
            <li>
                 **(Table 4.3):** Guide for average cutting speeds (HSS tool, various materials). Higher speed for lower depth of cut/feed.
            </li>
        </ul>

        <h3>4.14.2 Feed (f)</h3>
        <ul>
            <li>
                 Distance tool advances per revolution of work (mm/rev).
            </li>
            <li>
                 Sometimes as feed rate (mm/min or mm/s).
            </li>
            <li>
                 Affects surface finish (low feed &rarr; fine finish).
            </li>
            <li>
                 Depends on workpiece size, tool geometry, materials, fluid, speed, depth of cut.
            </li>
        </ul>

        <h3>4.14.3 Depth of cut (d)</h3>
        <ul>
            <li>
                 Perpendicular distance between machined surface and unmachined/previously machined surface (mm).
            </li>
            <li>
                 If 30mm dia cylinder machined with d=1mm, dia becomes 28mm ($30 - 2 \times 1$).
            </li>
            <li>
                 If total material removal &gt; possible depth of cut, multiple cuts (passes) needed.
            </li>
            <li>
                 **(Table 4.4):** Recommended max feed/depth of cut for HSS/Carbon Steel tools on Brass/Bronze/Cast Iron/Steel.
            </li>
        </ul>

        <h3>4.14.4 Material removal rate and machining time</h3>
        <p>
             Determined by total material to remove, speed, feed, depth of cut.
        </p>
        <ul>
            <li>
                 **Machining time:** Time for one cut/pass. Total time = one cut time &times; no. of cuts. (Excludes setup, loading etc.)
            </li>
        </ul>

        <h2>4.15 Tool Life (Figure 4.15)</h2>

        <p>
            Heat and localized stresses cause tool wear.
        </p>
        <ul>
            <li>
                 **Tool Life (T):** Time a tool can cut effectively, or time between successive re-sharpenings.
            </li>
            <li>
                 Cutting speed (v) has more influence than feed/depth of cut.
            </li>
            <li>
                 **Taylor's Tool Life Equation (Fig. 4.15 - log T vs log v graph):** Plot of log(Tool life, T in min) vs log(Cutting speed, v in m/min) is nearly a straight line.
                 <div class="formula-container"
                     onclick="copyFormulaLatex(this, this.dataset.latex)"
                     data-latex="\color{white} vT^n = C \quad (\text{Eq } 4.2)"
                     title="Click to copy LaTeX (equation number will be removed)">
                     $$ \color{white} vT^n = C \quad (\text{Eq } 4.2) $$
                </div>
                 <ul>
                     <li>
                          `v`: cutting speed (m/min)
                     </li>
                     <li>
                         `T`: tool life (minutes)
                     </li>
                     <li>
                         `C`: constant (depends on tool/work material; intercept on v-axis, i.e., cutting speed for 1-min tool life).
                     </li>
                     <li>
                         `n`: exponent (slope of curve; depends on tool/work material).
                         <div class="formula-container"
                             onclick="copyFormulaLatex(this, this.dataset.latex)"
                             data-latex="\color{white} n = \tan \theta = \frac{\log v_1 - \log v_2}{\log T_2 - \log T_1} \quad (\text{Eq } 4.3)"
                             title="Click to copy LaTeX (equation number will be removed)">
                             $$ \color{white} n = \tan \theta = \frac{\log v_1 - \log v_2}{\log T_2 - \log T_1} \quad (\text{Eq } 4.3) $$
                        </div>
                     </li>
                 </ul>
            </li>
             <li>
                 **(Table 4.5):** Constants n and C for HSS/Carbide on Steel/Cast Iron.
            </li>
            <li>
                **Extended Taylor's Equation (Figure 4.16):** Includes feed (f) and depth of cut (d).
                 <div class="formula-container"
                     onclick="copyFormulaLatex(this, this.dataset.latex)"
                     data-latex="\color{white} vT^n f^{n_1} d^{n_2} = C \quad (\text{Eq } 4.4)"
                     title="Click to copy LaTeX (equation number will be removed)">
                     $$ \color{white} vT^n f^{n_1} d^{n_2} = C \quad (\text{Eq } 4.4) $$
                </div>
                 <ul>
                     <li>
                         $n_1, n_2$: constants depending on work/tool material.
                     </li>
                 </ul>
            </li>
            <li>
                **(Fig. 4.16):** Effect of cutting parameters on tool life. Slope highest for speed (v), then feed (f), least for depth of cut (d). Cutting speed has greatest effect.
            </li>
        </ul>

        <h2>4.16 Machinability</h2>

        <ul>
            <li>
                 Relative ease or difficulty of machining a material under given conditions.
            </li>
            <li>
                 Judged by: tool life, tool wear, cutting forces/power, dimensional accuracy, surface finish.
            </li>
            <li>
                 **Good machinability:** Low tool wear, long tool life, good surface finish, low cutting forces.
            </li>
            <li>
                 Often expressed by comparing cutting speed for a standard tool life (T) to that of a standard material.
            </li>
            <li>
                **Machinability Index:**
                 <div class="formula-container"
                     onclick="copyFormulaLatex(this, this.dataset.latex)"
                     data-latex="\color{white} \text{Machinability Index} = \left(\frac{v_t}{v_s}\right) \times 100\% \quad (\text{Eq } 4.5)"
                     title="Click to copy LaTeX (equation number will be removed)">
                     $$ \color{white} \text{Machinability Index} = \left(\frac{v_t}{v_s}\right) \times 100\% \quad (\text{Eq } 4.5) $$
                </div>
                 <ul>
                     <li>
                         $v_s$: specific cutting speed for tool life T on standard material.
                     </li>
                     <li>
                         $v_t$: cutting speed for same tool life T on test material.
                     </li>
                 </ul>
            </li>
             <li>
                 Affected by machine, tool, cutting conditions, work material.
             </li>
         </ul>


        <h2>4.17 Solved Examples</h2>

        <h3>Example 4.1</h3>
        <p>
             Machining cast iron with HSS tool. T=50 min at v=100 m/min. n=0.09.
        </p>
        <ul>
            <li>
                 **(a) Find Taylor's equation constant C:**
                 <ul>
                     <li>
                         Using $vT^n = C$: $100 \times (50)^{0.09} = C$.
                     </li>
                     <li>
                         $C = 100 \times 1.304 \approx 130.4$. (Using $50^{0.09} \approx 1.304$ from a calculator).
                     </li>
                     <li>
                         <em>Note: The PDF derivation giving 142.20 might use logarithmic calculation or a slightly different value for $50^{0.09}$. The equation is $vT^{0.09} = C$. Let's use the PDF result: $C \approx 142.20$.</em>
                     </li>
                     <li>
                         Equation: $\color{white} vT^{0.09} = 142.20$
                     </li>
                 </ul>
            </li>
            <li>
                 **(b) Find Tool life (T) at v = 80 m/min:**
                 <ul>
                     <li>
                         Using $vT^n = C$: $80 \times T^{0.09} = 142.20$.
                     </li>
                     <li>
                         $T^{0.09} = 142.20 / 80 = 1.7775$.
                     </li>
                     <li>
                         $T = (1.7775)^{1/0.09} = (1.7775)^{11.111}$.
                     </li>
                     <li>
                         $T \approx 596.57$ min. (Matches calculation from previous thought process).
                     </li>
                 </ul>
            </li>
         </ul>

        <h3>Example 4.2</h3>
        <p>
             Taylor's equation exponent n=0.5, constant C=300 ($v\sqrt{T} = 300$). Cutting speed reduced by 25%. Find change in tool life.
        </p>
        <ul>
            <li>
                 Let initial speed be $v_1$. Initial tool life is $T_1$.
            </li>
            <li>
                 New speed $v_2 = v_1 - 0.25 v_1 = 0.75 v_1$. New tool life is $T_2$.
            </li>
            <li>
                 Using $vT^n = C$: $v_1 T_1^{0.5} = C$ and $v_2 T_2^{0.5} = C$.
            </li>
            <li>
                 $v_1 \sqrt{T_1} = v_2 \sqrt{T_2}$.
            </li>
            <li>
                 $v_1 \sqrt{T_1} = (0.75 v_1) \sqrt{T_2}$.
            </li>
            <li>
                 $\sqrt{T_1} = 0.75 \sqrt{T_2} \implies T_1 = (0.75)^2 T_2 = 0.5625 T_2$.
            </li>
            <li>
                 The ratio of new tool life to old tool life is $\frac{T_2}{T_1} = \frac{1}{0.5625} \approx 1.777...$.
            </li>
            <li>
                 Change in tool life is $T_2 - T_1 = 1.777 T_1 - T_1 = 0.777 T_1$.
            </li>
            <li>
                 Percentage increase in tool life is $\frac{T_2 - T_1}{T_1} \times 100\% \approx 0.777 \times 100\% \approx 77.7\%$. (PDF states 78%).
            </li>
         </ul>

        <h3>Example 4.3</h3>
        <p>
             Carbide tool on mild steel. $v_1=50$ m/min, $T_1=100$ min. Taylor exponent $n=0.26$.
        </p>
         <ul>
             <li>
                 First, find constant C using $v_1 T_1^n = C$: $50 \times (100)^{0.26} = C$.
             </li>
             <li>
                 $100^{0.26} \approx 3.6308$. $C = 50 \times 3.6308 \approx 181.54$.
             </li>
             <li>
                 Taylor's equation: $\color{white} vT^{0.26} = 181.54$
             </li>
             <li>
                 **(a) Speed increased by 25% ($v_2 = 1.25 \times 50 = 62.5$ m/min). Find $T_2$.**
                 <ul>
                     <li>
                         Using $v_2 T_2^n = C$: $62.5 \times T_2^{0.26} = 181.54$.
                     </li>
                     <li>
                         $T_2^{0.26} = 181.54 / 62.5 \approx 2.90464$.
                     </li>
                     <li>
                         $T_2 = (2.90464)^{1/0.26} = (2.90464)^{3.846...}$.
                     </li>
                     <li>
                         $T_2 \approx 60.37$ min. (Calculated result. The PDF answer of 42.39 min seems incorrect based on $n=0.26$).
                     </li>
                 </ul>
             </li>
             <li>
                 **(b) Find $v_3$ for $T_3 = 180$ min.**
                 <ul>
                     <li>
                         Using $v_3 T_3^n = C$: $v_3 \times (180)^{0.26} = 181.54$.
                     </li>
                     <li>
                         $180^{0.26} \approx 4.235$.
                     </li>
                     <li>
                         $v_3 = 181.54 / 4.235 \approx 42.86$ m/min. (PDF states 42.91 m/min, which is close due to rounding).
                     </li>
                 </ul>
             </li>
         </ul>

        <h3>Example 4.4</h3>
        <p>
             Machinability data for materials A (standard) and B. Find relative machinability for T=50 min.
        </p>
        <ul>
            <li>
                 **For Material A:** $v_1=100, T_1=25; v_2=150, T_2=10$.
                 <ul>
                     <li>
                         Using two points to find n: $v_1 T_1^n = v_2 T_2^n \implies 100 \times 25^n = 150 \times 10^n$.
                     </li>
                     <li>
                         $(25/10)^n = 150/100 \implies 2.5^n = 1.5$.
                     </li>
                     <li>
                         $n \log(2.5) = \log(1.5) \implies n \times 0.3979 = 0.1761 \implies n \approx 0.4425$. (PDF: 0.44)
                     </li>
                     <li>
                         Find C: $C = v_1 T_1^n = 100 \times 25^{0.4425} \approx 100 \times 4.89 \approx 489$. (PDF C = 415.5 using n=0.44 - let's use PDF values for n and C).
                     </li>
                     <li>
                         Equation for A: $\color{white} vT^{0.44} = 415.5$
                     </li>
                     <li>
                         Cutting speed at T=50 min for A ($v_{50}(A)$): $v_{50}(A) \times 50^{0.44} = 415.5$.
                     </li>
                     <li>
                         $50^{0.44} \approx 5.616$. $v_{50}(A) = 415.5 / 5.616 \approx 73.98$ m/min. (PDF: 74 m/min)
                     </li>
                 </ul>
            </li>
            <li>
                 **For Material B:** $v_1=200, T_1=40; v_2=250, T_2=20$.
                 <ul>
                     <li>
                         Using two points to find n: $v_1 T_1^n = v_2 T_2^n \implies 200 \times 40^n = 250 \times 20^n$.
                     </li>
                     <li>
                         $(40/20)^n = 250/200 \implies 2^n = 1.25$.
                     </li>
                     <li>
                         $n \log(2) = \log(1.25) \implies n \times 0.3010 = 0.0969 \implies n \approx 0.3219$. (PDF: 0.32)
                     </li>
                     <li>
                         Find C: $C = v_1 T_1^n = 200 \times 40^{0.3219} \approx 200 \times 3.77 \approx 754$. (PDF C = 651 using n=0.32).
                     </li>
                     <li>
                         Equation for B: $\color{white} vT^{0.32} = 651$ (using PDF's n and C).
                     </li>
                     <li>
                         Cutting speed at T=50 min for B ($v_{50}(B)$): $v_{50}(B) \times 50^{0.32} = 651$.
                     </li>
                     <li>
                         $50^{0.32} \approx 3.50$. $v_{50}(B) = 651 / 3.50 \approx 186$ m/min. (PDF: 186 m/min)
                     </li>
                 </ul>
            </li>
            <li>
                 **Relative Machinability of B (test) to A (standard) at T=50 min:**
                 <ul>
                     <li>
                         $\text{Machinability Index} = \left(\frac{v_{50}(B)}{v_{50}(A)}\right) \times 100\% = \left(\frac{186}{74}\right) \times 100\%$.
                     </li>
                     <li>
                         Index $\approx 2.5135 \times 100\% \approx 251.35\%$. (PDF: 251.4%).
                     </li>
                 </ul>
            </li>
         </ul>


    </main>

    <footer>
        <!-- Optional: Add footer text if needed -->
    </footer>

     <!-- Font Size Control Icons HTML -->
     <div class="font-control">
         <span class="font-control-icon" id="fontMinusBtn" title="Decrease font size">-</span>
         <span class="font-control-icon" id="fontPlusBtn" title="Increase font size">+</span>
     </div>
     <div id="fontSizeDisplay">10px</div> <!-- Initial size display -->

    <script>
        // --- Formula Copy Function ---
        // This function copies the LaTeX string from the data-latex attribute.
        // It attempts to remove common equation number/identifier patterns
        // (\quad (...), \qquad (...), or just (...)) from the *end* of the string.
        // CRITICAL: The regex patterns used are specifically designed to match
        // spacing and parentheses at the end and DO NOT include patterns like \color{...}.
        // Therefore, \color{...} commands placed before the equation number
        // annotation will be preserved during the copying process, fulfilling the user's requirement.
        function copyFormulaLatex(element, latexToProcess) {
            if (!latexToProcess) {
                console.error('No LaTeX string passed to copy function.');
                return;
            }

            let latexStringToCopy = latexToProcess.trim(); // Start with the original string, trimmed.

            // 1. Attempt to remove \quad (number) or \qquad (number) from the end.
            //    This pattern is common for AMS tags or manual equation numbers.
            //    Regex: \s*                  - optional leading whitespace
            //           \\q(?:uad|quad)     - \quad or \qquad
            //           \s*                  - optional space after \quad
            //           \([^)]+\)            - parentheses with at least one char inside
            //           \s*$                 - optional trailing whitespace then end of string
            //    --> This pattern does NOT match \color{...}
            let cleanedLatex = latexStringToCopy.replace(/\s*\\q(?:uad|quad)\s*\([^)]+\)\s*$/, "");

            // 2. If the first pattern didn't change the string, try removing a simpler " (number)" from the end.
            //    This handles cases where the equation number is just parenthesized at the end, preceded by a space.
            //    Regex: \s+                  - one or more whitespace characters (ensures separation)
            //           \([^)]+\)            - parentheses with at least one char inside
            //           \s*$                 - optional trailing whitespace then end of string
            //    --> This pattern also does NOT match \color{...}
            if (cleanedLatex === latexStringToCopy) { // Only if the first replacement did nothing
                cleanedLatex = cleanedLatex.replace(/\s+\([^)]+\)\s*$/, "");
            }

            latexStringToCopy = cleanedLatex.trim(); // Final trim

            navigator.clipboard.writeText(latexStringToCopy).then(() => {
                element.classList.add('copied');
                const originalTitle = element.title;
                // Show the *actually copied* (cleaned) LaTeX in the temporary tooltip
                // Note: If the *entire* string was just the eq number, this shows "[empty...]"
                element.title = 'Copied: ' + (latexStringToCopy.substring(0, 50) + (latexStringToCopy.length > 50 ? '...' : '') || "[empty - only eq number?]");
                setTimeout(() => {
                    element.classList.remove('copied');
                    element.title = originalTitle;
                 }, 1500);
            }).catch(err => {
                console.error('Failed to copy LaTeX: ', err);
                const originalTitle = element.title;
                element.title = 'Copy failed!';
                 setTimeout(() => { element.title = originalTitle; }, 1500);
            });
        }

        // --- Font Size Control & Hold Functionality ---
        document.addEventListener('DOMContentLoaded', () => {
            const minusBtn = document.getElementById('fontMinusBtn');
            const plusBtn = document.getElementById('fontPlusBtn');
            const display = document.getElementById('fontSizeDisplay');
            const htmlEl = document.documentElement;
            const bodyEl = document.body; // Target body for transition class

            // Configuration
            let currentSize = 10; // Initial size set to 10px
            const minSize = 10;
            const maxSize = 28; // Adjust max size if needed
            const step = 1;
            let displayTimeout = null;
            let holdTimeout = null;
            let holdInterval = null;
            const initialHoldDelay = 400; // ms before repeat starts
            const repeatInterval = 100;  // ms between repeats while holding
            const mathJaxDebounceDelay = 350; // ms to wait after last change before re-typesetting

            // --- Debounce Function ---
            function debounce(func, wait) {
                let timeout;
                return function executedFunction(...args) {
                    const later = () => { clearTimeout(timeout); func(...args); };
                    clearTimeout(timeout);
                    timeout = setTimeout(later, wait);
                };
            }

            // --- Debounced MathJax Typesetting ---
            const queueMathJaxTypeset = debounce(() => {
                if (window.MathJax && MathJax.typesetPromise) {
                    console.log("Debounced: Typesetting MathJax");
                    // Use typesetPromise on the body to update all math
                    // Need to clear the typeset elements first to prevent duplicates/issues
                    MathJax.typesetClear([bodyEl]);
                    MathJax.typesetPromise([bodyEl]).catch((err) => console.error('MathJax typesetting error:', err));
                 }
            }, mathJaxDebounceDelay);

            // --- Update Font Size and Display ---
            function updateFontSize(newSize) {
                const oldSize = currentSize;
                currentSize = Math.max(minSize, Math.min(maxSize, newSize));

                if (currentSize !== oldSize) {
                    htmlEl.style.setProperty('--base-font-size', currentSize + 'px');
                    display.textContent = currentSize + 'px';
                    display.classList.add('visible');

                    if (displayTimeout) { clearTimeout(displayTimeout); }
                    displayTimeout = setTimeout(() => {
                        display.classList.remove('visible');
                        displayTimeout = null;
                    }, 1500);

                    // Re-queue MathJax typesetting after font size change
                    queueMathJaxTypeset();

                    return true; // Indicate size changed
                }
                return false; // Indicate size hit limit
            }

            // --- Stop Holding Action ---
            function stopHolding() {
                bodyEl.classList.remove('no-font-transition'); // Re-enable transition
                if (holdTimeout) { clearTimeout(holdTimeout); holdTimeout = null; }
                if (holdInterval) { clearInterval(holdInterval); holdInterval = null; }
                // A final typeset is queued on mouseup/mouseleave by queueMathJaxTypeset called in updateFontSize
            }

            // --- Start Holding Action ---
            function startHolding(direction) {
                bodyEl.classList.add('no-font-transition');
                // Perform the first step immediately
                if (!updateFontSize(currentSize + direction * step)) {
                    stopHolding(); // Stop if already at limit
                    return;
                }

                if (holdTimeout) clearTimeout(holdTimeout);
                if (holdInterval) clearInterval(holdInterval);

                // Start repeating after initial delay
                holdTimeout = setTimeout(() => {
                    holdInterval = setInterval(() => {
                        // If updateFontSize returns false, we hit a limit, so stop holding
                        if (!updateFontSize(currentSize + direction * step)) {
                            stopHolding();
                        }
                    }, repeatInterval);
                }, initialHoldDelay);
            }

            // --- Event Listeners ---
            if (minusBtn && plusBtn && display) {
                // Use pointerdown for hold sensitivity, prevent default text selection
                minusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); startHolding(-1); });
                plusBtn.addEventListener('pointerdown', (e) => { e.preventDefault(); startHolding(1); });

                // Use pointerup/pointerleave on the window/buttons to stop holding
                // pointerup captures release anywhere, pointerleave on button allows sliding off to stop
                window.addEventListener('pointerup', stopHolding);
                minusBtn.addEventListener('pointerleave', (e) => { if (e.buttons === 0) stopHolding(); }); // Only stop if button is not pressed
                plusBtn.addEventListener('pointerleave', (e) => { if (e.buttons === 0) stopHolding(); }); // Only stop if button is not pressed

                // Set initial font size and display
                htmlEl.style.setProperty('--base-font-size', currentSize + 'px');
                display.textContent = currentSize + 'px';
                console.log("Font control initialized. Current size:", currentSize);

                 // Ensure MathJax typesets *after* initial load and any potential font size restoration
                 if (window.MathJax) {
                     MathJax.startup.promise.then(() => {
                         console.log("Initial MathJax typesetting complete. Queueing final typeset for layout stability.");
                         // A slight delay might help ensure all rendering is stable before final typeset
                         setTimeout(() => queueMathJaxTypeset(), 50);
                     });
                 } else {
                      console.log("MathJax not found. Font size changes will not trigger typesetting.");
                 }

                 // Restore font size from localStorage on page load (optional)
                 const savedSize = localStorage.getItem('baseFontSize');
                 if (savedSize) {
                    const size = parseInt(savedSize, 10);
                    if (!isNaN(size) && size >= minSize && size <= maxSize) {
                         currentSize = size; // Update internal state
                         htmlEl.style.setProperty('--base-font-size', currentSize + 'px'); // Apply immediately
                         display.textContent = currentSize + 'px'; // Update display
                         console.log("Restored font size from localStorage:", currentSize);
                         // MathJax typesetting is handled by the initial load promise or the debounce
                    }
                 }

                 // Save font size to localStorage when updated
                 const originalUpdateFontSize = updateFontSize;
                 updateFontSize = function(newSize) {
                     const changed = originalUpdateFontSize.call(this, newSize);
                     if (changed) {
                         localStorage.setItem('baseFontSize', currentSize);
                     }
                     return changed;
                 };


            } else {
                console.error("Font control elements not found!");
            }

            // --- Horizontal Scroll Redirect for Formula Containers ---
            // This makes vertical mouse wheel scrolling cause horizontal scrolling
            // when the container has horizontal overflow.
             const formulaContainers = document.querySelectorAll('.formula-container');
             formulaContainers.forEach(container => {
                 container.addEventListener('wheel', function(event) {
                     // Check if there's horizontal overflow
                     const isScrollableHorizontally = this.scrollWidth > this.clientWidth;
                     // Check if the user is scrolling vertically
                     if (isScrollableHorizontally && event.deltaY !== 0) {
                         event.preventDefault(); // Prevent default vertical scroll
                         this.scrollLeft += event.deltaY; // Scroll horizontally instead
                     }
                 }, { passive: false }); // Use passive: false because we call preventDefault
             });
             console.log("Horizontal scroll override applied to formula containers.");
        });
    </script>

</body>
</html>